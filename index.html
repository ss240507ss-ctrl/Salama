<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Salama">
    <title>Salama - AI Care Companion</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#0d9488">
    <link rel="apple-touch-icon" href="logo.png">
    <link rel="icon" type="image/png" href="logo.png">
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script type="text/babel">
        const { useState } = React;
        
        const User = ({className}) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
            </svg>
        );
        
        const Mic = ({className}) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3z"></path>
                <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
                <line x1="12" y1="19" x2="12" y2="23"></line>
                <line x1="8" y1="23" x2="16" y2="23"></line>
            </svg>
        );
        
        const Keyboard = ({className}) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <rect x="2" y="4" width="20" height="16" rx="2"></rect>
                <path d="M6 8h.01M10 8h.01M14 8h.01M18 8h.01M8 12h.01M12 12h.01M16 12h.01M7 16h10"></path>
            </svg>
        );
        
        const Users = ({className}) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
        );

        const SalamaApp = () => {
          const [currentPage, setCurrentPage] = useState('home');
          const [currentCardIndex, setCurrentCardIndex] = useState(0);
          const [selectedMood, setSelectedMood] = useState(null);
          const [isRecording, setIsRecording] = useState(false);
          const [showRecordings, setShowRecordings] = useState(false);
          const [touchStart, setTouchStart] = useState(null);
          const [touchEnd, setTouchEnd] = useState(null);
          const [selectedCaregiver, setSelectedCaregiver] = useState(null);
          const [sosPressed, setSosPressed] = useState(false);
          const [okPressed, setOkPressed] = useState(false);
          const [showSidebar, setShowSidebar] = useState(false);
          const [chatWith, setChatWith] = useState(null);
          const [showCommunities, setShowCommunities] = useState(false);
          const [chatMessages, setChatMessages] = useState([
            { text: "Hi! How are you today?", sender: "them", time: "10:30 AM" },
            { text: "I'm doing well, thanks for checking in!", sender: "me", time: "10:32 AM" }
          ]);
          const [messageInput, setMessageInput] = useState('');
          const [showProtectionChat, setShowProtectionChat] = useState(false);
          const [protectionMessages, setProtectionMessages] = useState([]);
          const [protectionInput, setProtectionInput] = useState('');
          const [isAIThinking, setIsAIThinking] = useState(false);
          const [backgroundMonitoring, setBackgroundMonitoring] = useState(true);
          const [monitoringAlerts, setMonitoringAlerts] = useState([]);
          const [salamaActive, setSalamaActive] = useState(false);
          const [isListening, setIsListening] = useState(false);
          const [salamaInput, setSalamaInput] = useState('');
          const [salamaConversation, setSalamaConversation] = useState([]);

          const moods = [
            { emoji: 'ðŸ˜¡', color: 'bg-red-500' },
            { emoji: 'ðŸ˜Ÿ', color: 'bg-orange-500' },
            { emoji: 'ðŸ˜', color: 'bg-yellow-500' },
            { emoji: 'ðŸ™‚', color: 'bg-lime-500' },
            { emoji: 'ðŸ˜Š', color: 'bg-green-500' }
          ];

          const homeCards = [
            { title: 'Medication ðŸ’Š', items: ['Med 1 - 8:00', 'Med 2 - 8:00 & 19:00', 'Med 3 - 11:00'] },
            { title: 'Appointments ðŸ“…', items: ['Dr. Smith - 14:00', 'Physical Therapy - 16:00'] }
          ];

          const careNotesCards = [
            { title: 'Documents ðŸ“', items: ['Test Results', 'Lab Reports', 'X-Rays', 'MRIs'], preview: true },
            { title: 'Other Expenses ðŸ’°', items: ['Salaries', 'Diapers', 'Medical Supplies'], preview: false }
          ];

          const caregivers = [
            { label: 'Primary Care-Giver', id: 1, name: 'Sarah Johnson' },
            { label: 'Secondary Care-Giver', id: 2, name: 'Michael Chen' },
            { label: 'Tertiary Care-Giver', id: 3, name: 'Emma Davis' },
            { label: 'Care-Giver 4', id: 4, name: 'David Wilson' },
            { label: 'Care-Giver 5', id: 5, name: 'Lisa Martinez' }
          ];

          const communities = [
            { id: 'internal', name: 'Internal (Caregivers)' },
            { id: 'group1', name: 'External (Elderly Group 1)' },
            { id: 'group2', name: 'External (Elderly Group 2)' },
            { id: 'group3', name: 'External (Elderly Group 3)' }
          ];

          const sendMessage = () => {
            if (messageInput.trim()) {
              setChatMessages([...chatMessages, {
                text: messageInput,
                sender: "me",
                time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
              }]);
              setMessageInput('');
            }
          };

          const askSalama = async (question) => {
            setProtectionMessages(prev => [...prev, {
              text: question,
              sender: "me",
              time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
            }]);
            setProtectionInput('');
            setIsAIThinking(true);

            setTimeout(() => {
              let response = "I'm here to help you stay safe. Tell me more details about what's concerning you.";
              if (question.toLowerCase().includes('call') || question.toLowerCase().includes('scam')) {
                response = "This appears to be a potential scam. Don't share personal information. I've notified your caregivers.";
              }
              
              setProtectionMessages(prev => [...prev, {
                text: response,
                sender: "salama",
                time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
              }]);
              setIsAIThinking(false);
            }, 2000);
          };

          const talkToSalama = async (question) => {
            setSalamaConversation(prev => [...prev, {
              text: question,
              sender: "me",
              time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
            }]);
            setSalamaInput('');
            setIsListening(false);
            setIsAIThinking(true);

            setTimeout(() => {
              let response = "I'm listening. How can I help you?";
              const lq = question.toLowerCase();
              
              if (lq.includes('weather')) response = "It's 72Â°F and sunny today. Perfect for a walk!";
              else if (lq.includes('news')) response = "Here are today's top stories: Markets are positive, and there's a seniors event at the community center Saturday.";
              else if (lq.includes('medication')) response = "You have Med 1 at 8:00 AM, Med 2 at 8:00 AM & 7:00 PM, and Med 3 at 11:00 AM today.";
              else if (lq.includes('joke')) response = "Why don't scientists trust atoms? Because they make up everything! ðŸ˜Š";
              
              setSalamaConversation(prev => [...prev, {
                text: response,
                sender: "salama",
                time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
              }]);
              setIsAIThinking(false);
            }, 2000);
          };

          const handleSwipe = () => {
            if (currentPage === 'home') {
              setCurrentCardIndex((prev) => (prev + 1) % homeCards.length);
            } else if (currentPage === 'carenotes') {
              setCurrentCardIndex((prev) => (prev + 1) % careNotesCards.length);
            }
          };

          const renderSwipeCard = (card) => {
            const totalCards = currentPage === 'home' ? homeCards.length : careNotesCards.length;
            
            return (
              <div className="relative">
                <div className="bg-white rounded-3xl p-8 shadow-2xl border-4 border-teal-700 mx-8 mb-4">
                  <div className="mb-6 pb-4 border-b-4 border-teal-700">
                    <h3 className="text-2xl font-serif text-black">{card.title}</h3>
                  </div>
                  <div className="mb-8">
                    {card.items.map((item, idx) => (
                      <p key={idx} className="text-xl text-black mb-2">{idx + 1}. {item}</p>
                    ))}
                  </div>
                  {card.preview && (
                    <div className="mb-8">
                      <div className="w-48 h-48 mx-auto border-4 border-black rounded-lg bg-white flex items-center justify-center">
                        <div className="w-12 h-12 rounded-full border-4 border-black"></div>
                      </div>
                    </div>
                  )}
                  <div className="flex justify-center gap-8">
                    <button onClick={() => setCurrentCardIndex((prev) => (prev - 1 + totalCards) % totalCards)}>
                      <svg className="w-12 h-12" viewBox="0 0 24 24" fill="none">
                        <path d="M19 12H5M5 12L12 5M5 12L12 19" stroke="black" strokeWidth="3"/>
                      </svg>
                    </button>
                    <button onClick={handleSwipe}>
                      <svg className="w-12 h-12" viewBox="0 0 24 24" fill="none">
                        <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="black" strokeWidth="3"/>
                      </svg>
                    </button>
                  </div>
                </div>
              </div>
            );
          };

          return (
            <div className="w-full min-h-screen bg-gradient-to-b from-teal-600 to-blue-300 pb-24">
              {showSidebar && (
                <>
                  <div className="fixed inset-0 bg-black/50 z-40" onClick={() => setShowSidebar(false)} />
                  <div className="fixed left-0 top-0 bottom-0 w-64 bg-teal-600 z-50 p-6">
                    <button onClick={() => setShowSidebar(false)} className="absolute top-4 right-4 text-white text-2xl">âœ•</button>
                    <div className="mt-12">
                      <button className="w-full text-left text-2xl text-white mb-6 p-3 rounded">1. Profile</button>
                      <button className="w-full text-left text-2xl text-white mb-6 p-3 rounded">2. Settings</button>
                      <button className="w-full text-left text-2xl text-white p-3 rounded">3. Log Out</button>
                    </div>
                  </div>
                </>
              )}

              {currentPage === 'home' && (
                <div className="p-6">
                  <div className="flex justify-between items-center mb-8">
                    <button onClick={() => setShowSidebar(true)} className="w-14 h-14 rounded-full border-2 border-white flex items-center justify-center">
                      <User className="w-8 h-8 text-white" />
                    </button>
                    <h1 className="text-4xl font-serif text-white">Home</h1>
                    <button onClick={() => alert('ðŸš¨ SOS!')} className="w-20 h-20 rounded-3xl bg-red-500 flex items-center justify-center">
                      <span className="text-white text-3xl font-bold">SOS</span>
                    </button>
                  </div>
                  <div className="text-center mb-8">
                    <div className="text-6xl font-bold text-white mb-2">19:11</div>
                    <div className="text-3xl text-black font-serif">Hello (Name)</div>
                    <div className="text-3xl text-black font-serif">How are you?</div>
                  </div>
                  <h2 className="text-5xl font-serif text-white text-center mb-8">Today's Recap</h2>
                  {renderSwipeCard(homeCards[currentCardIndex])}
                </div>
              )}

              {currentPage === 'checkin' && (
                <div className="p-6">
                  <div className="flex justify-between items-center mb-8">
                    <button onClick={() => setShowSidebar(true)} className="w-14 h-14 rounded-full border-2 border-white flex items-center justify-center">
                      <User className="w-8 h-8 text-white" />
                    </button>
                    <h1 className="text-4xl font-serif text-white">Check-In</h1>
                    <button className="w-20 h-20 rounded-3xl bg-red-500 flex items-center justify-center">
                      <span className="text-white text-3xl font-bold">SOS</span>
                    </button>
                  </div>
                  <h3 className="text-2xl text-black font-serif mb-4">How Am I Feeling?</h3>
                  <div className="flex justify-between px-4 mb-4">
                    {moods.map((mood, idx) => (
                      <button key={idx} onClick={() => setSelectedMood(idx)} 
                        className={`w-14 h-14 rounded-full ${mood.color} text-3xl ${selectedMood === idx ? 'scale-125' : ''}`}>
                        {mood.emoji}
                      </button>
                    ))}
                  </div>
                  <div className="h-3 bg-gradient-to-r from-red-500 via-yellow-500 to-green-500 rounded-full mx-4 mb-8"></div>
                  <h3 className="text-3xl text-black font-serif mb-4">Memories</h3>
                  <div className="grid grid-cols-3 gap-4 px-4">
                    {[1,2,3,4,5,6].map(i => (
                      <div key={i} className="aspect-square bg-white rounded-lg border-4 border-black"></div>
                    ))}
                  </div>
                </div>
              )}

              {currentPage === 'carenotes' && (
                <div className="p-6">
                  <div className="flex justify-between items-center mb-8">
                    <button onClick={() => setShowSidebar(true)} className="w-14 h-14 rounded-full border-2 border-white flex items-center justify-center">
                      <User className="w-8 h-8 text-white" />
                    </button>
                    <h1 className="text-4xl font-serif text-white">Care Notes</h1>
                    <button className="w-20 h-20 rounded-3xl bg-red-500 flex items-center justify-center">
                      <span className="text-white text-3xl font-bold">SOS</span>
                    </button>
                  </div>
                  {renderSwipeCard(careNotesCards[currentCardIndex])}
                </div>
              )}

              {currentPage === 'safety' && (
                <div className="p-6">
                  <div className="flex justify-between items-center mb-12">
                    <button onClick={() => setShowSidebar(true)} className="w-14 h-14 rounded-full border-2 border-white flex items-center justify-center">
                      <User className="w-8 h-8 text-white" />
                    </button>
                    <h1 className="text-4xl font-serif text-white">Safety</h1>
                    <div className="w-14"></div>
                  </div>
                  <div className="flex justify-center gap-8 mb-12">
                    <button onClick={() => alert('OK status sent!')} className="w-40 h-40 rounded-3xl bg-green-500 flex items-center justify-center">
                      <span className="text-white text-5xl font-bold">OK</span>
                    </button>
                    <button onClick={() => alert('ðŸš¨ SOS!')} className="w-40 h-40 rounded-3xl bg-red-500 flex items-center justify-center">
                      <span className="text-white text-5xl font-bold">SOS</span>
                    </button>
                  </div>
                  <h3 className="text-3xl text-black font-serif mb-4 underline">Protection</h3>
                  <button onClick={() => setShowProtectionChat(true)} className="text-xl text-black mb-3">â€¢ Speak</button><br/>
                  <button onClick={() => setShowProtectionChat(true)} className="text-xl text-black">â€¢ Type</button>
                </div>
              )}

              {currentPage === 'carecircle' && (
                <div className="p-6">
                  <div className="flex justify-between items-center mb-8">
                    <button onClick={() => setShowSidebar(true)} className="w-14 h-14 rounded-full border-2 border-white flex items-center justify-center">
                      <User className="w-8 h-8 text-white" />
                    </button>
                    <h1 className="text-4xl font-serif text-white">Care Circle</h1>
                    <button className="w-20 h-20 rounded-3xl bg-red-500 flex items-center justify-center">
                      <span className="text-white text-3xl font-bold">SOS</span>
                    </button>
                  </div>
                  <div className="grid grid-cols-2 gap-6 px-8 mt-12">
                    {caregivers.map(cg => (
                      <button key={cg.id} onClick={() => setChatWith({type: 'caregiver', name: cg.name})} className="flex flex-col items-center">
                        <div className="w-32 h-32 rounded-full border-4 border-black bg-teal-400 mb-3 flex items-center justify-center">
                          <User className="w-16 h-16 text-black" />
                        </div>
                        <p className="text-center text-lg text-black font-serif">{cg.label}</p>
                      </button>
                    ))}
                    <button onClick={() => setShowCommunities(true)} className="flex flex-col items-center">
                      <div className="w-32 h-32 rounded-full border-4 border-black bg-blue-300 mb-3 flex items-center justify-center">
                        <Users className="w-16 h-16 text-black" />
                      </div>
                      <p className="text-center text-lg text-black font-serif">Community</p>
                    </button>
                  </div>
                </div>
              )}

              <div className="fixed bottom-0 left-0 right-0 bg-white border-t border-teal-700 flex justify-around py-2 z-50">
                {[
                  {id:'home',label:'Home',icon:'ðŸ '},
                  {id:'checkin',label:'Check-In',icon:'ðŸ“'},
                  {id:'carenotes',label:'Care Notes',icon:'ðŸ“‹'},
                  {id:'safety',label:'Safety',icon:'ðŸ›¡ï¸'},
                  {id:'carecircle',label:'Care-Circle',icon:'ðŸ‘¥'}
                ].map(item => (
                  <button key={item.id} onClick={() => setCurrentPage(item.id)} className="flex flex-col items-center">
                    <span className="text-2xl">{item.icon}</span>
                    <span className={`text-xs ${currentPage === item.id ? 'text-teal-700 font-bold' : 'text-teal-600'}`}>{item.label}</span>
                  </button>
                ))}
              </div>
            </div>
          );
        };

        ReactDOM.render(<SalamaApp />, document.getElementById('root'));
    </script>
</body>
</html>
